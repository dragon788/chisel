<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Chisel by ckunte</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Chisel</h1>
      <h2 class="project-tagline">A simple python static blog generation utility.</h2>
      <a href="https://github.com/ckunte/chisel" class="btn">View on GitHub</a>
      <a href="https://github.com/ckunte/chisel/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/ckunte/chisel/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="chisel" class="anchor" href="#chisel" aria-hidden="true"><span class="octicon octicon-link"></span></a>Chisel</h1>

<p>Written by <a href="https://github.com/dz">David Zhou</a> in <a href="http://www.python.org/">python</a>, forked and enhanced by <a href="https://github.com/ckunte">Chyetanya Kunte</a>, <a href="https://github.com/ckunte/chisel">Chisel</a> is an extremely lightweight (just 8kB) blog generating script. </p>

<p>This fork includes the following additions and enhancements:</p>

<ul>
<li>Smartypants content parsing to emit typographically nicer quotes, proper em and en dashes, etc.</li>
<li>A shorter (just year based) permalink structure.</li>
<li>RSS feed for posts.</li>
<li>Page support with markdown. (Use <code>{% markdown %}Markdown formatted content here.{% endmarkdown %}</code>)</li>
<li>Support for Page titles in title tag for permalinks added in templates.</li>
<li>Supports clean URLs.</li>
<li>Works just fine with <a href="http://www.mathjax.org/">MathJax</a> for rendering using <a href="http://en.wikipedia.org/wiki/LaTeX">LaTeX</a> (math syntax). (Just remember to use <code>\newline</code> for multiple lines instead of <code>\n</code>. For mathjax support, see the section below.)</li>
<li>Sitemap auto-generation for posts (gzipped).</li>
<li>List number of posts using <code>{{ entries | length }}</code> in Jinja (archive.html) template.</li>
<li>Time taken to read a post using <code>{{ entry.content | wordcount // 300 + 1 }} min read</code>, where 300 is the number of words a typical reader reads per minute. (Posts less than 1 minute long to read will approximate to 1 min.)</li>
</ul>

<h2>
<a id="what-it-does-not-do" class="anchor" href="#what-it-does-not-do" aria-hidden="true"><span class="octicon octicon-link"></span></a>What it does not do</h2>

<p>Chisel keeps it simple and stupid. And so, there is</p>

<ul>
<li>No taxonomy support, i.e., no categories, and no tags.</li>
<li>No built-in search. (A simple json based search script may easily be developed together with a gzipped flat file index for text query.)</li>
<li>Multiple posts in a day, since the time stamp is simple without the time element. This does not mean multiple posts do not show up. They will just be ordered by title alphabetically.</li>
</ul>

<h2>
<a id="what-it-does-best" class="anchor" href="#what-it-does-best" aria-hidden="true"><span class="octicon octicon-link"></span></a>What it does best</h2>

<ul>
<li>No loss of fidelity. All posts would be plain text, which kind of makes it timeless. Great for archiving. Burn on a CD, or save it on a USB stick.</li>
<li>Regenerate the entire site again if one just has the native markdown draft posts, and Chisel + templates.</li>
<li>It's incredibly lightweight -- less than 8kB! (Compare that with anything out there, and they all seem like they weigh a ton, not to mention the complexity of install, maintain, and backup.)</li>
<li>Zero security issues. Generate site locally, and upload only the thus created html files out of markdown post drafts. </li>
<li>Pure static site. Pretty robust to network spikes, and heavy loads. No server-side scripting ensures no overload.</li>
<li>Helps you blog offline, run your own private blog, information system, if you don't want to host it on the web, and still have a web like interface.</li>
<li>Written in python: Simple to understand, simple to modify, but most of all, simpler to use. (Knowledge of python is not required, except for installation, which is explained in detail below.)</li>
</ul>

<h2>
<a id="how-it-works" class="anchor" href="#how-it-works" aria-hidden="true"><span class="octicon octicon-link"></span></a>How it works</h2>

<ol>
<li><p>Write the post in Markdown, save it as <code>post-title.md</code> or <code>posttitle.md</code> (or post_title.md) in a designated folder, say, <code>posts</code>. </p></li>
<li><p>Run <code>python chisel.py</code> in a Terminal, and Chisel will parse all <code>.md</code>, <code>.markdown</code> or <code>.mdown</code> files in <code>posts</code> folder to another designated folder, say <code>www</code> in html -- ready to be served using a web server.</p></li>
<li><p>Sync [See Note] all files and folders from the local <code>www</code> folder to the root of your web host, and you've got a fully functioning web site.</p></li>
</ol>

<p>(Note: There are a number of ways one can sync files, <a href="http://git-scm.com">git</a>, <a href="http://en.wikipedia.org/wiki/Rsync">rsync</a>, or plain vanilla (s)<a href="http://panic.com/transmit/">ftp</a>. The sync can be further automated using a (ana)cron job, or via the Automator.)</p>

<h2>
<a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h2>

<p>If you are using a Mac or Linux, then python comes pre-installed. In addition, you'll need just a few python packages for Chisel to function. They are as follow:</p>

<ol>
<li>
<a href="http://jinja.pocoo.org/docs/">Jinja2</a> is a templating engine, developed by <a href="http://www.pocoo.org/" title="Led by Georg Brandl and Armin Ronacher.">Pocoo Team</a>.</li>
<li>
<a href="http://daringfireball.net/projects/markdown/">Markdown</a> is a text markup language, developed by <a href="http://daringfireball.net/" title="John Gruber">John Gruber</a>. It's nearly plain text, i.e., zero learning curve, which is why it's awesome.</li>
<li>
<a href="https://github.com/danielchatfield/jinja2_markdown">jinja_markdown</a> to render markdown in pages.</li>
</ol>

<h4>
<a id="install-these-on-a-mac-os-x-via-pip----python-package-installer" class="anchor" href="#install-these-on-a-mac-os-x-via-pip----python-package-installer" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install these on a <a href="http://www.apple.com/macosx">Mac OS X</a> via <a href="http://pypi.python.org/pypi/pip">pip</a> -- python package installer:</h4>

<pre><code>$ sudo easy_install pip
Password:
$ sudo pip install jinja2 markdown jinja2_markdown
</code></pre>

<h4>
<a id="on-ubuntu-debian-linux" class="anchor" href="#on-ubuntu-debian-linux" aria-hidden="true"><span class="octicon octicon-link"></span></a>On <a href="http://www.ubuntu.com/">Ubuntu</a> (Debian) linux:</h4>

<pre><code>$ sudo apt-get install python-pip
Password:
$ sudo pip install jinja2 markdown jinja2_markdown
</code></pre>

<p>To update these packages, you may run the following:</p>

<pre><code>$ sudo pip install --upgrade jinja2 markdown jinja2_markdown
</code></pre>

<h2>
<a id="create-a-site-structure-on-your-computer-this-is-just-an-example" class="anchor" href="#create-a-site-structure-on-your-computer-this-is-just-an-example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Create a site structure on your computer (This is just an example)</h2>

<pre><code>$ mkdir ~/site
$ cd ~/site
$ mkdir posts www chisel
</code></pre>

<p>Now download Chisel as a zip file or via git (<code>git clone git://github.com/ckunte/chisel.git</code>). Move the unzipped contents into <code>chisel</code> folder created above. The structure should look like this following:</p>

<pre><code>~/site/
~/site/posts/
~/site/www/
~/site/chisel/
             /README.md
             /chisel.py
             /templates/
                       /archive.html
                       /base.html
                       /detail.html
                       /home.html
</code></pre>

<p>While it is not required, keeping <code>chisel</code>, <code>posts</code>, and <code>www</code> separate is a good idea. It helps keep chisel folders clean (for future updates), aside from keeping the tool separated from the content you create using it (<code>posts</code>, and <code>www</code>).</p>

<p>Remember to open and edit templates, particularly <code>base.html</code> as it contains site name, description and other <code>meta</code> into in the <code>&lt;head&gt;</code> section hard-coded. In addition, you will need to update the settings below.</p>

<h3>
<a id="updating-settings-to-suit" class="anchor" href="#updating-settings-to-suit" aria-hidden="true"><span class="octicon octicon-link"></span></a>Updating Settings to suit</h3>

<p>Open <code>chisel.py</code> in a text editor and have a look at the section Settings. You may need to update the following:</p>

<pre><code># Settings
BASEURL = "http://mysite.net/" # Must end with a trailing slash.
SOURCE = "../posts/"             # Must end with a trailing slash.
DESTINATION = "../www/"          # Must end with a trailing slash.
HOME_SHOW = 15                   # Number of entries to show on homepage.
TEMPLATE_PATH = "./templates/"   # Path of Jinja2 template files.
TIME_FORMAT = "%b %d, %Y"
ENTRY_TIME_FORMAT = "%m/%d/%Y"
FORMAT = lambda text: markdown.markdown(text, ['footnotes','smartypants',])
</code></pre>

<h3>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<pre><code>$ cd ~/Sites/chisel
$ python chisel.py
</code></pre>

<h3>
<a id="sample-entry" class="anchor" href="#sample-entry" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sample Entry</h3>

<p><code>sample.markdown</code> (Note: Filenames shall not have spaces. Good examples: <code>hotel-california.md</code>, <code>i_love_cooking.md</code>, and so on):</p>

<pre><code>Title of the post
3/14/1879

Content in Markdown here onward.

Next paragraph.

Next paragraph.
</code></pre>

<p>The very simple post entry format, shown above, is as follows:</p>

<ul>
<li>Line 1: Enter a Title.</li>
<li>Line 2: Enter date in m/d/Y format.</li>
<li>Line 3: Blank line.</li>
<li>Line 4: Content in Markdown here onward.</li>
</ul>

<h3>
<a id="adding-steps" class="anchor" href="#adding-steps" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding Steps</h3>

<p>Use the <a href="https://github.com/step" class="user-mention">@step</a> decorator. The main loop passes in the master file list and jinja environment. Here's an example of a <code>@step</code> decorator added to <code>chisel.py</code> to generate a colophon page:</p>

<p>Add this below in <code>chisel.py</code> code:</p>

<pre><code>@step
def gen_colophon(f, e):
    write_file('colophon' + URLEXT, e.get_template('colophon.html').render(entry=file))
</code></pre>

<h3>
<a id="clean-urls---howto" class="anchor" href="#clean-urls---howto" aria-hidden="true"><span class="octicon octicon-link"></span></a>Clean URLs - Howto</h3>

<p>GitHub (via nginx rewrite I think) recognizes post files ending with <code>.html</code> or feed URLs ending with <code>.xml</code>. So, generate the files with these extensions as usual, but tell chisel to skip the extensions in permalinks using settings. (Follow up by excluding .html extension in hard links in Jinja templates too.)</p>

<p>The default setting in chisel now -- assuming server recognizes <code>.html</code> extension but does not require its inclusion when referring to a URL -- is as follows:</p>

<pre><code>URLEXT = ""
</code></pre>

<p>This above is what I use. (Note that you should not set both to empty or <code>.html</code> strings in the above; this would lead to unintended results.)</p>

<p>The fallback option is as follows:</p>

<pre><code>URLEXT = ".html"
</code></pre>

<p>This above setting would be suitable if your server does not recognize <code>.html</code> files if they are referred to without <code>.html</code> extension in URLs.</p>

<h4>
<a id="local-server-at-home" class="anchor" href="#local-server-at-home" aria-hidden="true"><span class="octicon octicon-link"></span></a>Local server at home</h4>

<p>Since I also run chisel on my home server, here's what I had to do to enable rewrite using nginx web server:</p>

<p>I edited the <code>default</code> file, which serves our local family site, in the following folder on my home server:</p>

<pre><code>cd /etc/nginx/sites-enabled
</code></pre>

<p>and added this following in it:</p>

<pre><code>location / {
    try_files $uri.html $uri/ =404;
    error_page 404 = /404.html;
}
</code></pre>

<p>I now get clean URLs with these above settings.</p>

<h3>
<a id="can-i-use-this-to-run-a-site-locally-like-offline" class="anchor" href="#can-i-use-this-to-run-a-site-locally-like-offline" aria-hidden="true"><span class="octicon octicon-link"></span></a>Can I use this to run a site locally, like offline?</h3>

<p>Yes! Just navigate to <code>~/site/www</code> and run the following to start a simple HTTP server in Terminal:</p>

<pre><code>$ python -m SimpleHTTPServer
</code></pre>

<p>Then, point your browser to: <code>http://localhost:8000</code> and your site is live on your computer.</p>

<h3>
<a id="i-have-a-large-number-of-posts-in-wordpress-how-do-i-convert" class="anchor" href="#i-have-a-large-number-of-posts-in-wordpress-how-do-i-convert" aria-hidden="true"><span class="octicon octicon-link"></span></a>I have a large number of posts in WordPress. How do I convert?</h3>

<p>Have a look at Thomas Fr√∂ssman's tool, <a href="https://github.com/thomasf/exitwp">exitwp</a>. While it's written primarily for Jekyll, it does a very good job of converting all WordPress posts to Markdown post -- one file per post. Each post thus converted shows some preformatted lines in the beginning. much of which you don't need in Chisel (You only require Title and Date in the format illustrated above.) You could either manually edit each markdown file, or you could fork Thomas's exitwp and change the following lines (between line 253 and 259) from</p>

<pre><code>yaml_header = {
      'title': i['title'],
      'date': i['date'],
      'slug': i['slug'],
      'status': i['status'],
      'wordpress_id': i['wp_id'],
    }
</code></pre>

<p>to</p>

<pre><code>   yaml_header = {
      i['title'],
      i['date'],
    }
</code></pre>

<p>Further, the date would need a fix to read as m/d/Y. But at least for now, it reduces your edits to just changing dates. Or you could write a <a href="http://www.cyberciti.biz/faq/unix-linux-replace-string-words-in-many-files/">shell script</a> to chuck out needless information generated for Jekyll to suit Chisel.</p>

<h2>
<a id="i-miss-pinging-my-site-via-pingomatic-how-do-i" class="anchor" href="#i-miss-pinging-my-site-via-pingomatic-how-do-i" aria-hidden="true"><span class="octicon octicon-link"></span></a>I miss pinging my site via Pingomatic. How do I?</h2>

<p>Create and save a bookmarklet via <a href="http://pingomatic.com/">Pingomatic</a>. Alternatively, put the following script (hat-tip: <a href="http://nedbatchelder.com/blog/200406/pingomatic_and_xmlrpc.html" title="Ping-o-matic and xml-rpc">Ned Batchelder</a> for this script) in a file, say <code>ping.py</code>, and run <code>python ping.py</code> (please do remember to change the title and URL in the script below):</p>

<pre><code># encoding: utf-8
#!/usr/bin/env python

import xmlrpclib

# Ping-o-matic the Pinging service:
ps = "http://rpc.pingomatic.com/RPC2"

# Your site's title, url and rss:
title = "Site title"
url = "http://mysite.net"
rss = "http://mysite.net/log/rss"

remoteServer = xmlrpclib.Server(ps)
ret = remoteServer.weblogUpdates.ping(title, url, rss)
print title, ret['message']
</code></pre>

<p>To map by pinging each and every post from an entire site, one may use a script like below using archive.html page as the sitemap:</p>

<pre><code>#!/usr/bin/env python
# encoding: utf-8
"""
mapsite.py
2014-06-07: Created by ckunte.
2014-08-28: Updated to urllib3, and beautifulsoup4.

Requirements:
    1. beautifulsoup4 module. (pip install beautifulsoup4)
    2. A file named srvclst.txt with ping servers list.

Usage:

    $ python mapsite.py

"""
import bs4
import urllib3
import xmlrpclib

#--- Start edit: site details ---------------------
# For absolute links: SITEURL = ''
# For relative links: SITEURL = 'http://mysite.com'
SITEURL = 'http://mysite.com'
SITETITLE = 'Site title'
SITEMAP = 'http://mysite.com/log/archive.html'
#--- End edit. ------------------------------------

def main():
    servers = [line.strip() for line in open('srvclst.txt', 'r')]
    http = urllib3.PoolManager()
    html_page = http.urlopen('GET', SITEMAP, preload_content=False)
    soup = bs4.BeautifulSoup(html_page)
    for link in soup.find_all('a'):
        title = SITETITLE + ": " + link.contents[0]
        url = SITEURL + link.get('href')
        for ps in servers:
            remoteServer = xmlrpclib.Server(ps)
            push = remoteServer.weblogUpdates.ping(title, url)
            print title, push['message']
        pass
    pass

if __name__ == '__main__':
    main()
</code></pre>

<p>In addition, all update services may be populated in a file called <code>srvclst.txt</code>, e.g.,</p>

<pre><code>http://rpc.pingomatic.com/RPC2
http://blogsearch.google.com/ping/RPC2
http://rpc.weblogs.com/RPC2
</code></pre>

<p>Stepping through the code above, here's what it does:</p>

<ul>
<li>Lines between 20 and 22 require some basic input, viz., sitemap url, site title, and site url. (For absolute urls, site url may be left blank. Since, I use relative urls, I define a root.)</li>
<li>Line 22 defines the sitemap, and is called into BeautifulSoup on line 29.</li>
<li>Line 26 converts a list of servers/services (one per line) from <code>srvclst.txt</code> and turns it in to a proper python list.</li>
<li>Each link (within <code>a</code> html tags), together with the linked text as its title in sitemap (or my Archive page) is pushed to all servers/services in the list --- defined above (line 30).</li>
<li>Line 36 prints the title of the page, and each server's response to the push.</li>
</ul>

<h2>
<a id="my-blog-is-now-powered-by-chisel-how-do-i-automate-all-this" class="anchor" href="#my-blog-is-now-powered-by-chisel-how-do-i-automate-all-this" aria-hidden="true"><span class="octicon octicon-link"></span></a>My blog is now powered by Chisel. How do I automate all this?</h2>

<p>Easy. Put this in a script (say, <code>log.sh</code>, for example) like the example below (do take note of folders, these are from my set-up, if yours is setup differently, then do make those changes in lines 3, 5, and 10 below):</p>

<pre><code>#!/usr/bin/env sh
echo ""
cd ~/Sites/chisel
python chisel.py
cd ~/Sites/mysiterepo.github.io
echo "Updating log.."
git add -A
git commit -m 'Updating log.'
git push -u origin master
cd ~/Sites/chisel
echo "Pinging Pingomatic.."
python ping.py
cd ~/
echo ""
echo "All done."
</code></pre>

<p>When you're ready to generate and post it to your site, run <code>sh log.sh</code>, and your post(s) are published.</p>

<h2>
<a id="mathjax-support" class="anchor" href="#mathjax-support" aria-hidden="true"><span class="octicon octicon-link"></span></a>MathJax support</h2>

<p>For enabling MathJax (TEX-AMS_HTML), the following script may be added in the <code>head</code> section:</p>

<pre><code>&lt;script defer src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"&gt;&lt;/script&gt;
</code></pre>

<p>The URL may be suitably changed to suit if other forms of markup is desired for for rendering. Please see mathjax website for more details on implementation.</p>

<p>For inline TEX rendering, the following may be added before the <code>&lt;/head&gt;</code> tag in <code>base.html</code> template.</p>

<pre><code>&lt;script type="text/x-mathjax-config"&gt;
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
&lt;/script&gt;
</code></pre>

<p>For a new equation, remember to use <code>\newline</code> instead of <code>\n</code>.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/ckunte/chisel">Chisel</a> is maintained by <a href="https://github.com/ckunte">ckunte</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

